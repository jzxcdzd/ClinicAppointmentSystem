<html>
    <head>
        <title>Hello World</title>
        <!-- Bootstrap CSS CDN -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <!-- Link to external CSS -->
        <link rel="stylesheet" href="../css/index.css">
    </head>
    <body>
        <div class="container mt-4 text-center">
            <div class="d-flex flex-column align-items-center">
                <button type="button" class="btn btn-primary btn-lg appointment-btn mb-3" onclick="window.location.href='patient_login.html';">
                    I want to make an appointment.
                </button>
                <button type="button" class="btn btn-secondary physician-btn" onclick="window.location.href='physician_login.html';">
                    I am a physician.
                </button>
                <!-- Replace existing debug buttons with four side-by-side buttons -->
                <div class="btn-group mt-3" role="group" aria-label="Debug Buttons">
                    <button type="button" class="btn btn-danger debug-reset-btn" onclick="resetDatabase();">
                        Debug: Reset Database
                    </button>
                    <button type="button" class="btn btn-danger debug-showdb-btn" data-bs-toggle="modal" data-bs-target="#databaseModal" onclick="showPatientDb();">
                        Debug: Show patientDb
                    </button>
                    <button type="button" class="btn btn-danger debug-showdb-btn" data-bs-toggle="modal" data-bs-target="#databaseModal" onclick="showPhysicianDb();">
                        Debug: Show physicianDb
                    </button>
                    <button type="button" class="btn btn-danger debug-showdb-btn" data-bs-toggle="modal" data-bs-target="#databaseModal" onclick="showAppointmentsDb();">
                        Debug: Show appointmentsDb
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal for displaying database contents -->
        <div class="modal fade" id="databaseModal" tabindex="-1" aria-labelledby="databaseModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="databaseModalLabel">Database Contents</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <pre id="databaseContents" style="white-space: pre-wrap; word-wrap: break-word;"></pre>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bootstrap JS (optional) & dependencies -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <!-- Main script with type="module" -->
        <script type="module">
            import { initializeAppointmentsDb } from '../js/appointmentsDb.js';
            import { initializePhysiciansDb } from '../js/physicianDb.js';
            import { initializePatientsDb } from '../js/patientDb.js';

            // Initialize all databases
            initializeAppointmentsDb();
            initializePhysiciansDb();
            initializePatientsDb();

            // Define resetDatabase function
            function resetDatabase() {
                localStorage.clear();
                alert("Database has been reset. Reloading the page...");
                location.reload();
            }

            function showPatientDb() {
                const patientData = JSON.parse(localStorage.getItem('patientData')) || [];
                document.getElementById('databaseContents').textContent = JSON.stringify(patientData, null, 2);
            }

            function showPhysicianDb() {
                const physicianData = JSON.parse(localStorage.getItem('physicianData')) || [];
                document.getElementById('databaseContents').textContent = JSON.stringify(physicianData, null, 2);
            }

            function showAppointmentsDb() {
                const appointmentData = JSON.parse(localStorage.getItem('appointmentData')) || [];
                document.getElementById('databaseContents').textContent = JSON.stringify(appointmentData, null, 2);
            }

            // Attach functions to the global window object
            window.resetDatabase = resetDatabase;
            window.showPatientDb = showPatientDb;
            window.showPhysicianDb = showPhysicianDb;
            window.showAppointmentsDb = showAppointmentsDb;
        </script>
    </body>
</html>